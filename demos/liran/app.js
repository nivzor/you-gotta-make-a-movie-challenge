var rickFrames = [{
    "height": 140,
    "rotate": 0,
    "translateX": 499.5,
    "translateY": 225.5,
    "duration": 0,
    "minute": 0
}, {
    "translateX": 502.5,
    "translateY": 210.5,
    "duration": 500,
    "minute": 500
}, {
    "translateX": 492.5,
    "translateY": 217.5,
    "duration": 500,
    "minute": 1000
}, {
    "translateX": 507.5,
    "translateY": 224.5,
    "duration": 500,
    "minute": 1500
}, {
    "rotate": -10,
    "translateX": 490.5,
    "translateY": 220.5,
    "duration": 500,
    "minute": 2000
}, {
    "rotate": 5,
    "translateX": 524.5,
    "translateY": 200.5,
    "duration": 500,
    "minute": 2500
}, {
    "translateX": 530.5,
    "translateY": 206.5,
    "duration": 500,
    "minute": 3000
}, {
    "rotate": -13,
    "translateX": 492.5,
    "translateY": 241.5,
    "duration": 500,
    "minute": 3500
}, {
    "height": 150,
    "translateX": 478.5,
    "translateY": 240.5,
    "duration": 500,
    "minute": 4000
}, {
    "rotate": -17,
    "translateX": 478.5,
    "translateY": 250.5,
    "duration": 500,
    "minute": 4500
}, {
    "translateX": 478.5,
    "translateY": 240.5,
    "duration": 500,
    "minute": 5000
}, {
    "translateX": 478.5,
    "translateY": 240.5,
    "duration": 500,
    "minute": 5500
}, {
    "height": 160,
    "rotate": -12,
    "translateX": 474.5,
    "translateY": 236.5,
    "duration": 500,
    "minute": 6000
}, {
    "height": 170,
    "translateX": 450.5,
    "translateY": 260.5,
    "duration": 500,
    "minute": 6500
}, {
    "translateX": 460.5,
    "translateY": 283.5,
    "duration": 500,
    "minute": 7000
}, {
    "height": 180,
    "translateX": 450.5,
    "translateY": 283.5,
    "duration": 500,
    "minute": 7500
}, {
    "translateX": 460.5,
    "translateY": 283.5,
    "duration": 500,
    "minute": 8000
}, {
    "translateX": 460.5,
    "translateY": 233.5,
    "duration": 500,
    "minute": 8500
}, {
    "translateX": 430.5,
    "translateY": 203.5,
    "duration": 500,
    "minute": 9000
}, {
    "height": 190,
    "translateX": 438.5,
    "translateY": 203.5,
    "duration": 500,
    "minute": 9500
}, {
    "height": 200,
    "rotate": -18,
    "translateX": 418.5,
    "translateY": 220.5,
    "duration": 500,
    "minute": 10000
}, {
    "height": 210,
    "rotate": -13,
    "translateX": 435,
    "translateY": 230.5,
    "duration": 500,
    "minute": 10500
}, {
    "height": 220,
    "rotate": -14,
    "translateX": 425,
    "translateY": 230.5,
    "duration": 500,
    "minute": 11000
}, {
    "translateX": 385,
    "translateY": 230.5,
    "duration": 500,
    "minute": 11500
}, {
    "translateX": 355,
    "translateY": 230,
    "duration": 500,
    "minute": 12000
}, {
    "height": 260,
    "translateX": 315,
    "translateY": 230,
    "duration": 500,
    "minute": 12500
}, {
    "rotate": -18,
    "translateX": 285,
    "translateY": 230,
    "duration": 500,
    "minute": 13000
}];
var mortyFrames = [{
    "height": 100,
    "translateX": 573,
    "translateY": 165.5,
    "duration": 0,
    "minute": 0
}, {
    "translateX": 563,
    "translateY": 163,
    "duration": 500,
    "minute": 500
}, {
    "translateX": 553,
    "translateY": 168,
    "duration": 500,
    "minute": 1000
}, {
    "translateX": 568,
    "translateY": 175,
    "duration": 500,
    "minute": 1500
}, {
    "translateX": 575,
    "translateY": 163,
    "duration": 500,
    "minute": 2000
}, {
    "translateX": 586,
    "translateY": 157,
    "duration": 500,
    "minute": 2500
}, {
    "translateX": 592,
    "translateY": 165,
    "duration": 500,
    "minute": 3000
}, {
    "translateX": 581,
    "translateY": 188,
    "duration": 500,
    "minute": 3500
}, {
    "translateX": 574,
    "translateY": 192,
    "duration": 500,
    "minute": 4000
}, {
    "translateX": 571,
    "translateY": 198,
    "duration": 500,
    "minute": 4500
}, {
    "translateX": 579,
    "translateY": 192,
    "duration": 500,
    "minute": 5000
}, {
    "height": 115,
    "translateX": 596,
    "translateY": 180,
    "duration": 500,
    "minute": 5500
}, {
    "translateX": 603,
    "translateY": 175,
    "duration": 500,
    "minute": 6000
}, {
    "translateX": 596,
    "translateY": 201,
    "duration": 500,
    "minute": 6500
}, {
    "translateX": 592,
    "translateY": 221,
    "duration": 500,
    "minute": 7000
}, {
    "height": 125,
    "translateX": 586,
    "translateY": 229,
    "duration": 500,
    "minute": 7500
}, {
    "translateX": 583,
    "translateY": 220,
    "duration": 500,
    "minute": 8000
}, {
    "height": 130,
    "translateX": 564,
    "translateY": 186,
    "duration": 500,
    "minute": 8500
}, {
    "height": 140,
    "translateX": 544,
    "translateY": 158,
    "duration": 500,
    "minute": 9000
}, {
    "translateX": 563,
    "translateY": 156,
    "duration": 500,
    "minute": 9500
}, {
    "height": 150,
    "translateX": 570,
    "translateY": 167,
    "duration": 500,
    "minute": 10000
}, {
    "height": 160,
    "translateX": 597,
    "translateY": 181,
    "duration": 500,
    "minute": 10500
}, {
    "translateX": 598,
    "translateY": 171,
    "duration": 500,
    "minute": 11000
}, {
    "height": 180,
    "translateX": 571,
    "translateY": 181,
    "duration": 500,
    "minute": 11500
}, {
    "translateX": 533,
    "translateY": 190,
    "duration": 500,
    "minute": 12000
}, {
    "translateX": 538,
    "translateY": 200,
    "duration": 500,
    "minute": 12500
}, {
    "height": 200,
    "translateX": 526,
    "translateY": 184,
    "duration": 500,
    "minute": 13000
}];
var rickHeight = 140;
var rickWidth = 120;
var mortyHeight = 100;
var mortyWidth = 100;

var rickAnimation = {
    targets: '#rick',
    opacity: [
        {
            value: 0,
            duration: 0
        },
        {
            duration: 900
        },
        {
            value: 1,
            duration: 0
        },
        {
            value: 1,
            duration: 12430
        },
        {
            value: 0,
            duration: 0
        }
    ],
    height: rickFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.height) {
            obj.value = point.height;
        }

        return obj;
    }),
    translateX: rickFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.translateX) {
            obj.value = point.translateX - (rickWidth / 1.5);
        }

        return obj;
    }),
    translateY: rickFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.translateY) {
            obj.value = point.translateY - (rickHeight / 1.5);
        }

        return obj;
    }),
    rotate: rickFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.rotate) {
            obj.value = point.rotate;
        }

        return obj;
    }),
};

var mortyAnimation = {
    targets: '#morty',
    opacity: [
        {
            value: 0,
            duration: 0
        },
        {
            duration: 900
        },
        {
            value: 1,
            duration: 0
        },
        {
            value: 1,
            duration: 12430
        },
        {
            value: 0,
            duration: 0
        }
    ],
    height: mortyFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.height) {
            obj.value = point.height;
        }

        return obj;
    }),
    translateX: mortyFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.translateX) {
            obj.value = point.translateX - 20;
        }

        return obj;
    }),
    translateY: mortyFrames.map(function (point, idx) {
        var obj = {
            duration: point.duration || (idx ? 50 : 0)
        };

        if (point.translateY) {
            obj.value = point.translateY - 20;
        }

        return obj;
    }),
};

var rickTl = anime.timeline({
    duration: 20000,
    easing: 'linear',
    autoplay: false,
}).add(rickAnimation);

var mortyTl = anime.timeline({
    duration: 20000,
    easing: 'linear',
    autoplay: false,
}).add(mortyAnimation);

var firstPlay = true;
var videoPlayer = new Plyr('#player', {
    controls: ['play', 'play-large', 'progress', 'current-time', 'mute', 'volume'], // 'fullscreen'
    // debug: true,
    keyboard: {
        focused: true,
        global: true
    },
    storage: {
        enabled: false
    },
    volume: 0,
    seekTime: 0.5,
    invertTime: false
});

var soundPlayer = new Plyr('#sound_player', {
    controls: [],
    // debug: true,
    keyboard: {
        focused: false,
        global: false
    },
    storage: {
        enabled: false
    },
    volume: 1,
    seekTime: 0.5
});

videoPlayer.on('play', event => {
    rickTl.play();
    mortyTl.play();
    soundPlayer.play();
    duration = Date.now();
    if (firstPlay) {
        soundPlayer.currentTime = 4.8;
        firstPlay = false;
    }
});

videoPlayer.on('pause', event => {
    rickTl.pause();
    mortyTl.pause();
    soundPlayer.pause();
    console.log('Paused at: ', videoPlayer.currentTime * 1000);
});

videoPlayer.on('seeking', event => {
    rickTl.seek(videoPlayer.currentTime * 1000);
    mortyTl.seek(videoPlayer.currentTime * 1000);
    soundPlayer.currentTime = videoPlayer.currentTime;
});

videoPlayer.on('seeked', event => {
    console.log('Paused at: ', videoPlayer.currentTime * 1000);
});

// My Code
var canvas = document.getElementById('canvas');
var points = [];
var duration = player.currentTime * 1000;

canvas.addEventListener('click', function (e) {
    var bounding = canvas.getBoundingClientRect();
    var now = player.currentTime * 1000;
    if (now < 0) {
        now = 0;
    }

    points.push({
        translateX: e.pageX - bounding.x,
        translateY: e.pageY - bounding.y,
        duration: now - duration,
        minute: now
    });

    duration = now;

    console.log('points', JSON.stringify(points));
});